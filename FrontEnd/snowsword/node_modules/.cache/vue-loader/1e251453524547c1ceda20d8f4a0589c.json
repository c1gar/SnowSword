{"remainingRequest":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/src/views/database/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/src/views/database/index.vue","mtime":1671438929000},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/cache-loader/dist/cjs.js","mtime":1715570484549},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/babel-loader/lib/index.js","mtime":1715570465906},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/cache-loader/dist/cjs.js","mtime":1715570484549},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/vue-loader/lib/index.js","mtime":1715570461633}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCByZXF1ZXN0IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCcKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29udGV4dE1lbnU6ewogICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgIHRvcDogMCwKICAgICAgICBsZWZ0OiAwLAogICAgICAgIGhlaWdodDowCiAgICAgIH0sCgogICAgICBkYXRhYmFzZUluZm9Gb3JtOnsKICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgaXNVcGRhdGU6IGZhbHNlLAogICAgICAgIGhvc3Q6ICIiLAogICAgICAgIHBvcnQ6IDMzMDYsCiAgICAgICAgdXNlcm5hbWU6ICIiLAogICAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgICB0eXBlOiAiIiwKICAgICAgICBjb2RlOiAiIiwKICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICB3ZWJzaGVsbElkOm51bGwsCiAgICAgICAgdGFiX2luZGV4Om51bGwsCiAgICAgIH0sCgogICAgICBlbF90cmVlX3Byb3BzOnsKICAgICAgICBsYWJlbDogJ25hbWUnLAogICAgICAgIGlzTGVhZjogJ2lzbGVhZicKICAgICAgfSwKCiAgICAgIHdlYnNoZWxsczogWwogICAgICAgIC8vIHsKICAgICAgICAvLyAgIGlkOiAxLAogICAgICAgIC8vICAgdXJsOiAiaHR0cDovL3FxLmNvbS8xLnBocCIsCiAgICAgICAgLy8gfQogICAgICBdLAoKICAgICAgY29udGVudDp7CiAgICAgICAgY3VycmVudFRhYk5hbWU6ICIiLAogICAgICAgIHRhYkluZGV4OjAsCgogICAgICAgIHRhYnM6WwogICAgICAgIF0sCiAgICAgIH0sCgogICAgICBzZWxlY3RXZWJzaGVsbEZvcm06ewogICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgIHdlYnNoZWxsSWQ6IG51bGwKICAgICAgfQoKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGxvYWROb2RlKG5vZGUsIHJlc29sdmUsIGl0ZW0pIHsKICAgICAgaWYgKG5vZGUubGV2ZWwgPT09IDApIHsgICAvL+i/lOWbnuaVsOaNruW6k+mFjee9ruWIl+ihqAoKICAgICAgICByZXF1ZXN0KHsKICAgICAgICAgIHVybDogJy9kYXRhYmFzZUNvbmYvZ2V0QnlXZWJTaGVsbElkJywKICAgICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgICBwYXJhbXM6IHsgaWQ6aXRlbS53ZWJzaGVsbElkIH0gCiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CgogICAgICAgICAgbGV0IHVybCA9IHJlc3BvbnNlLmRhdGEudXJsOwogICAgICAgICAgbGV0IHJlcyA9IHVybC5tYXRjaCgvaHR0cHM/OlwvXC8oLiopP1wvLyk7CiAgICAgICAgICBpZihyZXMpewogICAgICAgICAgICBpdGVtLnRpdGxlID0gcmVzWzFdOwogICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIGl0ZW0udGl0bGUgPSB1cmw7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgZGF0YWJhc2VJbmZvcyA9IHJlc3BvbnNlLmRhdGEuZGF0YWJhc2VzOwoKICAgICAgICAgIGxldCBkYXRhID0gW107CiAgICAgICAgICBkYXRhYmFzZUluZm9zLmZvckVhY2goZnVuY3Rpb24odmFsdWUsaW5kZXgpIHsKICAgICAgICAgICAgbGV0IHRtcCA9IHt9OwogICAgICAgICAgICB0bXBbIm5hbWUiXSA9IHZhbHVlLnVzZXJuYW1lKyJAIit2YWx1ZS5ob3N0KyI6Iit2YWx1ZS5wb3J0OwogICAgICAgICAgICB0bXBbImlkIl0gPSB2YWx1ZS5pZDsgICAvL+iusOW9leaVsOaNruW6k+mFjee9rmlkCiAgICAgICAgICAgIHRtcFsibm9kZUtleSJdID0gdmFsdWUuaWQ7CgogICAgICAgICAgICB0bXBbImhvc3QiXSA9IHZhbHVlLmhvc3Q7ICAgLy/orrDlvZXlhbbku5bphY3nva7kv6Hmga/vvIzkvpvlj7PplK7ngrnlh7vnvJbovpHkuIDmnaHphY3nva7ml7blj5bnlKgKICAgICAgICAgICAgdG1wWyJwb3J0Il0gPSB2YWx1ZS5wb3J0OwogICAgICAgICAgICB0bXBbInVzZXJuYW1lIl0gPSB2YWx1ZS51c2VybmFtZTsKICAgICAgICAgICAgdG1wWyJwYXNzd29yZCJdID0gdmFsdWUucGFzc3dvcmQ7CiAgICAgICAgICAgIHRtcFsiY29kZSJdID0gdmFsdWUuY29kZTsKICAgICAgICAgICAgdG1wWyJ3ZWJzaGVsbElkIl0gPSBpdGVtLndlYnNoZWxsSWQ7CiAgICAgICAgICAgIGRhdGEucHVzaCh0bXApOwogICAgICAgICAgfSk7CgogICAgICAgICAgaWYoSlNPTi5zdHJpbmdpZnkoZGF0YSk9PT0nW10nKXsgICAgICAgLy/liKTmlq3mmK/lkKbmmK/nqbrmlbDnu4QKICAgICAgICAgICAgaXRlbS5lbXB0eSA9IHRydWU7CiAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgaXRlbS5lbXB0eSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy4kZm9yY2VVcGRhdGUoKTsKCiAgICAgICAgICByZXNvbHZlKGRhdGEpOwoKICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICBpdGVtLnRpdGxlID0gIuWKoOi9veWksei0pSI7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgfSkKCiAgICAgIH0KCiAgICAgIGlmIChub2RlLmxldmVsID09PSAxKSB7ICAgLy/ngrnlh7vkuobmn5DmnaHmlbDmja7lupPphY3nva7vvIzlupTor6Xov5Tlm57mlbDmja7lupPlkI3liJfooagKICAgICAgICBjb25zdCBkYXRhYmFzZUluZm9JZCA9IG5vZGUuZGF0YS5pZDsgIC8v5pWw5o2u5bqT6YWN572uaWQKCiAgICAgICAgcmVxdWVzdCh7CiAgICAgICAgICB1cmw6ICcvZGF0YWJhc2VDb25mL2dldERhdGFiYXNlcycsCiAgICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgICAgcGFyYW1zOiB7IGlkOmRhdGFiYXNlSW5mb0lkIH0gCiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CgogICAgICAgICAgY29uc3QgZGF0YWJhc2VzID0gcmVzcG9uc2UuZGF0YVswXTsKCiAgICAgICAgICBsZXQgZGF0YSA9IFtdOwogICAgICAgICAgZGF0YWJhc2VzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsaW5kZXgpIHsKICAgICAgICAgICAgbGV0IHRtcCA9e307CiAgICAgICAgICAgIHRtcFsibmFtZSJdID0gT2JqZWN0LnZhbHVlcyh2YWx1ZSlbMF07ICAvL+aYvuekuueahOWQjeensOOAgeaVsOaNruW6k+WQjQogICAgICAgICAgICB0bXBbImlkIl0gPSBkYXRhYmFzZUluZm9JZDsgICAvL+iusOW9leaVsOaNruW6k+mFjee9rmlkCiAgICAgICAgICAgIHRtcFsibm9kZUtleSJdID0gZGF0YWJhc2VJbmZvSWQrIi4iK09iamVjdC52YWx1ZXModmFsdWUpWzBdOwogICAgICAgICAgICBkYXRhLnB1c2godG1wKTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgICAgICBub2RlLmxvYWRlZCA9IGZhbHNlOyAgLy/orr7nva5sb2FkZWTkuLpmYWxzZe+8jOi/meagt+avj+asoeaKmOWPoOWQjuWGjeWxleW8gOaXtuS8mumHjeaWsOivt+axguWQjuerr+iOt+WPluacgOaWsOaVsOaNrgogICAgICAgICAgbm9kZS5pc0xlYWYgPSBmYWxzZTsKCiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgcmVzb2x2ZShbXSk7ICAvL3Jlc29sdmXnqbrmlbDnu4TlkI7vvIzkvJrlj5jmiJDlj7blrZDoioLngrnvvIzkuIvpnaLorr7nva7lm57pnZ7lj7blrZDoioLngrnvvIzlubbkuJTorr7nva7kuLrpnZ7lsZXlvIDmnKrliqDovb3vvIzorqnnlKjmiLflj6/ku6Xph43mlrDngrnlh7vliqDovb0KICAgICAgICAgIG5vZGUuZXhwYW5kZWQgPSBmYWxzZTsKICAgICAgICAgIG5vZGUubG9hZGVkID0gZmFsc2U7CiAgICAgICAgICBub2RlLmlzTGVhZiA9IGZhbHNlOwogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgIH0pCgogICAgICB9CgogICAgICBpZiAobm9kZS5sZXZlbCA9PT0gMikgeyAgIC8v54K55Ye75LqG5p+Q5pWw5o2u5bqT77yM5bqU6K+l6L+U5Zue6KGo5ZCN5YiX6KGoCiAgICAgICAgY29uc3QgZGF0YWJhc2VJbmZvSWQgPSBub2RlLmRhdGEuaWQ7ICAvL+aVsOaNruW6k+mFjee9rmlkCiAgICAgICAgY29uc3QgZGJuYW1lID0gbm9kZS5kYXRhLm5hbWU7ICAvL+aVsOaNruW6k+WQjQoKICAgICAgICByZXF1ZXN0KHsKICAgICAgICAgIHVybDogJy9kYXRhYmFzZUNvbmYvZ2V0VGFibGVzJywKICAgICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgICBwYXJhbXM6IHsgCiAgICAgICAgICAgIGlkOmRhdGFiYXNlSW5mb0lkLAogICAgICAgICAgICBkYm5hbWU6ZGJuYW1lCiAgICAgICAgICB9IAogICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewoKICAgICAgICAgIGNvbnN0IHRhYmxlcyA9IHJlc3BvbnNlLmRhdGFbMF07CgogICAgICAgICAgbGV0IGRhdGEgPSBbXTsKICAgICAgICAgIHRhYmxlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLGluZGV4KSB7CiAgICAgICAgICAgIGxldCB0bXAgPXt9OwogICAgICAgICAgICB0bXBbIm5hbWUiXSA9IE9iamVjdC52YWx1ZXModmFsdWUpWzBdOyAgLy/mmL7npLrnmoTlkI3np7DjgIHooajlkI0KICAgICAgICAgICAgdG1wWyJpZCJdID0gZGF0YWJhc2VJbmZvSWQ7ICAgLy/orrDlvZXmlbDmja7lupPphY3nva5pZAogICAgICAgICAgICB0bXBbImRibmFtZSJdID0gZGJuYW1lOyAgIC8v6K6w5b2V5pWw5o2u5bqT5ZCNCiAgICAgICAgICAgIHRtcFsibm9kZUtleSJdID0gIjMuIitkYXRhYmFzZUluZm9JZCsiLiIrZGJuYW1lKyIuIitPYmplY3QudmFsdWVzKHZhbHVlKVswXTsKICAgICAgICAgICAgZGF0YS5wdXNoKHRtcCk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXNvbHZlKGRhdGEpOwogICAgICAgICAgbm9kZS5sb2FkZWQgPSBmYWxzZTsgIC8v6K6+572ubG9hZGVk5Li6ZmFsc2XvvIzov5nmoLfmr4/mrKHmipjlj6DlkI7lho3lsZXlvIDml7bkvJrph43mlrDor7fmsYLlkI7nq6/ojrflj5bmnIDmlrDmlbDmja4KICAgICAgICAgIG5vZGUuaXNMZWFmID0gZmFsc2U7CgogICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgIHJlc29sdmUoW10pOyAgLy9yZXNvbHZl56m65pWw57uE5ZCO77yM5Lya5Y+Y5oiQ5Y+25a2Q6IqC54K577yM5LiL6Z2i6K6+572u5Zue6Z2e5Y+25a2Q6IqC54K577yM5bm25LiU6K6+572u5Li66Z2e5bGV5byA5pyq5Yqg6L2977yM6K6p55So5oi35Y+v5Lul6YeN5paw54K55Ye75Yqg6L29CiAgICAgICAgICBub2RlLmV4cGFuZGVkID0gZmFsc2U7CiAgICAgICAgICBub2RlLmxvYWRlZCA9IGZhbHNlOwogICAgICAgICAgbm9kZS5pc0xlYWYgPSBmYWxzZTsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICB9KQoKICAgICAgfQoKICAgICAgaWYgKG5vZGUubGV2ZWwgPT09IDMpIHsgICAvL+eCueWHu+S6huafkOihqO+8jOW6lOivpei/lOWbnuWIl+WQjeWIl+ihqAogICAgICAgIGNvbnN0IGRhdGFiYXNlSW5mb0lkID0gbm9kZS5kYXRhLmlkOyAgLy/mlbDmja7lupPphY3nva5pZAogICAgICAgIGNvbnN0IGRibmFtZSA9IG5vZGUuZGF0YS5kYm5hbWU7ICAvL+aVsOaNruW6k+WQjQogICAgICAgIGNvbnN0IHRhYmxlID0gbm9kZS5kYXRhLm5hbWU7ICAvL+ihqOWQjQoKICAgICAgICByZXF1ZXN0KHsKICAgICAgICAgIHVybDogJy9kYXRhYmFzZUNvbmYvZ2V0Q29sdW1ucycsCiAgICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgICAgcGFyYW1zOiB7IAogICAgICAgICAgICBpZDpkYXRhYmFzZUluZm9JZCwKICAgICAgICAgICAgZGJuYW1lOmRibmFtZSwKICAgICAgICAgICAgdGFibGU6dGFibGUKICAgICAgICAgIH0gCiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CgogICAgICAgICAgY29uc3QgY29sdW1ucyA9IHJlc3BvbnNlLmRhdGFbMF07CgogICAgICAgICAgbGV0IGRhdGEgPSBbXTsKICAgICAgICAgIGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSxpbmRleCkgewogICAgICAgICAgICBsZXQgdG1wID17fTsKICAgICAgICAgICAgdG1wWyJuYW1lIl0gPSB2YWx1ZS5GaWVsZCsiICggIit2YWx1ZS5UeXBlKyIgKSAiOyAgLy/mmL7npLrnmoTlkI3np7AKICAgICAgICAgICAgdG1wWyJpZCJdID0gZGF0YWJhc2VJbmZvSWQ7ICAgLy/orrDlvZXmlbDmja7lupPphY3nva5pZAogICAgICAgICAgICB0bXBbImRibmFtZSJdID0gZGJuYW1lOyAgIC8v6K6w5b2V5pWw5o2u5bqT5ZCNCiAgICAgICAgICAgIHRtcFsidGFibGUiXSA9IHRhYmxlOyAgIC8v6K6w5b2V6KGo5ZCNCiAgICAgICAgICAgIHRtcFsiY29sdW1uIl0gPSB2YWx1ZS5GaWVsZDsgIC8v6K6w5b2V5YiX5ZCNCiAgICAgICAgICAgIHRtcFsiaXNsZWFmIl0gPSB0cnVlOyAvL+ihqOekuuaYr+WPtuWtkOiKgueCuQogICAgICAgICAgICBkYXRhLnB1c2godG1wKTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgICAgICBub2RlLmxvYWRlZCA9IGZhbHNlOyAgLy/orr7nva5sb2FkZWTkuLpmYWxzZe+8jOi/meagt+avj+asoeaKmOWPoOWQjuWGjeWxleW8gOaXtuS8mumHjeaWsOivt+axguWQjuerr+iOt+WPluacgOaWsOaVsOaNrgogICAgICAgICAgbm9kZS5pc0xlYWYgPSBmYWxzZTsKCiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgcmVzb2x2ZShbXSk7ICAvL3Jlc29sdmXnqbrmlbDnu4TlkI7vvIzkvJrlj5jmiJDlj7blrZDoioLngrnvvIzkuIvpnaLorr7nva7lm57pnZ7lj7blrZDoioLngrnvvIzlubbkuJTorr7nva7kuLrpnZ7lsZXlvIDmnKrliqDovb3vvIzorqnnlKjmiLflj6/ku6Xph43mlrDngrnlh7vliqDovb0KICAgICAgICAgIG5vZGUuZXhwYW5kZWQgPSBmYWxzZTsKICAgICAgICAgIG5vZGUubG9hZGVkID0gZmFsc2U7CiAgICAgICAgICBub2RlLmlzTGVhZiA9IGZhbHNlOwogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgIH0pCgogICAgICB9CiAgICB9LAoKICAgIHRlc3QoKXsKICAgICAgY29uc29sZS5sb2coMSk7CiAgICB9LAoKICAgIGhhbmRsZVRhYnNFZGl0KHRhcmdldE5hbWUsIGFjdGlvbikgewogICAgICBpZiAoYWN0aW9uID09PSAnYWRkJykgewogICAgICAgIHRoaXMuc2VsZWN0V2Vic2hlbGwoZmFsc2UpOwogICAgICB9CiAgICAgIGlmIChhY3Rpb24gPT09ICdyZW1vdmUnKSB7CiAgICAgICAgbGV0IHRhYnMgPSB0aGlzLmNvbnRlbnQudGFiczsKICAgICAgICBsZXQgYWN0aXZlTmFtZSA9IHRoaXMuY29udGVudC5jdXJyZW50VGFiTmFtZTsKICAgICAgICBpZiAoYWN0aXZlTmFtZSA9PT0gdGFyZ2V0TmFtZSkgewogICAgICAgICAgdGFicy5mb3JFYWNoKCh0YWIsIGluZGV4KSA9PiB7CiAgICAgICAgICAgIGlmICh0YWIubmFtZSA9PT0gdGFyZ2V0TmFtZSkgewogICAgICAgICAgICAgIGxldCBuZXh0VGFiID0gdGFic1tpbmRleCArIDFdIHx8IHRhYnNbaW5kZXggLSAxXTsKICAgICAgICAgICAgICBpZiAobmV4dFRhYikgewogICAgICAgICAgICAgICAgYWN0aXZlTmFtZSA9IG5leHRUYWIubmFtZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0aGlzLmNvbnRlbnQuY3VycmVudFRhYk5hbWUgPSBhY3RpdmVOYW1lOwogICAgICAgIHRoaXMuY29udGVudC50YWJzID0gdGFicy5maWx0ZXIodGFiID0+IHRhYi5uYW1lICE9PSB0YXJnZXROYW1lKTsKICAgICAgfQogICAgfSwKCiAgICBmZXRjaFdlYnNoZWxsRGF0YSgpewogICAgICByZXF1ZXN0KHsKICAgICAgICB1cmw6ICcvd2Vic2hlbGwvZmluZEFsbCcsCiAgICAgICAgbWV0aG9kOiAnZ2V0JywKICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy53ZWJzaGVsbHMgPSByZXNwb25zZS5kYXRhOwogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KQogICAgfSwKCiAgICBzZWxlY3RXZWJzaGVsbChpc0FkZFRhYil7CiAgICAgIGlmKGlzQWRkVGFiKXsKICAgICAgICB0aGlzLnNlbGVjdFdlYnNoZWxsRm9ybS52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgbGV0IG5ld1RhYk5hbWUgPSArK3RoaXMuY29udGVudC50YWJJbmRleCArICcnOwogICAgICAgIGxldCB3ZWJzaGVsbElkID0gdGhpcy5zZWxlY3RXZWJzaGVsbEZvcm0ud2Vic2hlbGxJZDsKCiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jb250ZW50LnRhYnMucHVzaCh7CiAgICAgICAgICB0aXRsZTogIuWKoOi9veS4rS4uLiIsCiAgICAgICAgICBuYW1lOiBuZXdUYWJOYW1lLAogICAgICAgICAgd2Vic2hlbGxJZDp3ZWJzaGVsbElkLAogICAgICAgICAgbGltaXQ6MTAwLAogICAgICAgICAgZGF0YWJhc2VDb25mOiIiLAogICAgICAgICAgZGF0YWJhc2VDb25mSWQ6MCwKICAgICAgICAgIGRibmFtZToiIiwKICAgICAgICB9KS0xOwogICAgICAgIHRoaXMuY29udGVudC5jdXJyZW50VGFiTmFtZSA9IG5ld1RhYk5hbWU7CgogICAgICB9ZWxzZXsKICAgICAgICB0aGlzLnNlbGVjdFdlYnNoZWxsRm9ybS52aXNpYmxlID0gdHJ1ZTsKICAgICAgfQogICAgfSwKCiAgICBhZGREYXRhYmFzZUluZm8oaXNTdWJtaXQsaXRlbSxpbmRleCl7CiAgICAgIGlmKGlzU3VibWl0KXsKICAgICAgICByZXF1ZXN0KHsKICAgICAgICAgIHVybDogJy9kYXRhYmFzZUNvbmYvYWRkJywKICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgICAgZGF0YTogeyAKICAgICAgICAgICAgd2Vic2hlbGxJZDp0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ud2Vic2hlbGxJZCwKICAgICAgICAgICAgaG9zdDp0aGlzLmRhdGFiYXNlSW5mb0Zvcm0uaG9zdCwKICAgICAgICAgICAgcG9ydDp0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ucG9ydCwKICAgICAgICAgICAgdXNlcm5hbWU6dGhpcy5kYXRhYmFzZUluZm9Gb3JtLnVzZXJuYW1lLAogICAgICAgICAgICBwYXNzd29yZDp0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ucGFzc3dvcmQsCiAgICAgICAgICAgIGNvZGU6dGhpcy5kYXRhYmFzZUluZm9Gb3JtLmNvZGUsCiAgICAgICAgICB9IAogICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBtZXNzYWdlOiAn5re75Yqg5oiQ5YqfJwogICAgICAgICAgfSk7CgogICAgICAgICAgdGhpcy5yZWZyZXNoRGF0YSh0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udGFiX2luZGV4KTsKICAgICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvRm9ybS52aXNpYmxlID0gZmFsc2U7CgogICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICB9KQogICAgICB9ZWxzZXsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udGl0bGUgPSAi5re75Yqg6YWN572uIjsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0uaXNVcGRhdGUgPSBmYWxzZTsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0uaG9zdCA9ICIiOwogICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvRm9ybS5wb3J0ID0gMzMwNjsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udXNlcm5hbWUgPSAiIjsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ucGFzc3dvcmQgPSAiIjsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udHlwZSA9ICJNeXNxbCI7CiAgICAgICAgdGhpcy5kYXRhYmFzZUluZm9Gb3JtLmNvZGUgPSAidXRmOCI7CiAgICAgICAgdGhpcy5kYXRhYmFzZUluZm9Gb3JtLnZpc2libGUgPSB0cnVlOwoKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ud2Vic2hlbGxJZCA9IGl0ZW0ud2Vic2hlbGxJZDsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udGFiX2luZGV4ID0gaW5kZXg7CiAgICAgIH0KICAgIH0sCgogICAgYWRkT3JVcGRhdGVEYXRhYmFzZUluZm8oKXsKICAgICAgaWYodGhpcy5kYXRhYmFzZUluZm9Gb3JtLmlzVXBkYXRlKXsKICAgICAgICB0aGlzLnVwZGF0ZURhdGFiYXNlSW5mbyh0cnVlKTsKICAgICAgfWVsc2V7CiAgICAgICAgdGhpcy5hZGREYXRhYmFzZUluZm8odHJ1ZSxudWxsLG51bGwpOwogICAgICB9CiAgICB9LAoKICAgIHJlZnJlc2hEYXRhKGluZGV4KXsKICAgICAgdGhpcy4kcmVmcy50cmVlW2luZGV4XS5yb290LmxvYWRlZCA9IGZhbHNlOwogICAgICB0aGlzLiRyZWZzLnRyZWVbaW5kZXhdLnJvb3QuZXhwYW5kZWQgPSBmYWxzZTsKICAgICAgdGhpcy4kcmVmcy50cmVlW2luZGV4XS5yb290LmV4cGFuZCgpOwogICAgfSwKCiAgICBub2RlUmlnaHRDbGljayhldmVudCxub2RlLGl0ZW0saW5kZXgpewogICAgICB0aGlzLmNsb3NlTWVudSgpOwogICAgICBpZiAobm9kZS5sZXZlbCA9PSAxKXsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBjb25zdCBvZmZzZXRMZWZ0ID0gdGhpcy4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdAogICAgICAgIGNvbnN0IGxlZnQgPSBldmVudC5jbGllbnRYIC0gb2Zmc2V0TGVmdDsKICAgICAgICB0aGlzLmNvbnRleHRNZW51LmxlZnQgPSBsZWZ0OwogICAgICAgIGlmICggKGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0IC0gZXZlbnQucGFnZVkpIDwgdGhpcy5jb250ZXh0TWVudS5oZWlnaHQgKXsKICAgICAgICAgIHRoaXMuY29udGV4dE1lbnUudG9wID0gZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQgLSB0aGlzLmNvbnRleHRNZW51LmhlaWdodC03MDsKICAgICAgICB9ZWxzZXsKICAgICAgICAgIHRoaXMuY29udGV4dE1lbnUudG9wID0gZXZlbnQucGFnZVkgLSA2MDsKICAgICAgICB9CiAgICAgICAgdGhpcy5jb250ZXh0TWVudS52aXNpYmxlID0gdHJ1ZTsKCiAgICAgICAgdGhpcy5jb250ZXh0TWVudS5pdGVtID0gaXRlbTsgICAgIC8v6K6w5b2VaXRlbeWSjGluZGV46L+Y5pyJbm9kZSzlnKjngrnlh7voj5zljZXkuK3nmoTpgInpobnml7bpnIDopoHnlKjliLDov5nkuKTkuKrlgLwKICAgICAgICB0aGlzLmNvbnRleHRNZW51LmluZGV4ID0gaW5kZXg7CiAgICAgICAgdGhpcy5jb250ZXh0TWVudS5ub2RlID0gbm9kZTsKCiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2VNZW51KTsKICAgICAgfQogICAgfSwKCiAgICBjbG9zZU1lbnUoKSB7CiAgICAgIHRoaXMuY29udGV4dE1lbnUudmlzaWJsZSA9IGZhbHNlOwogICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZU1lbnUpOwogICAgfSwKCiAgICB1cGRhdGVEYXRhYmFzZUluZm8oaXNTdWJtaXQpewogICAgICBpZihpc1N1Ym1pdCl7CgogICAgICAgIHJlcXVlc3QoewogICAgICAgICAgdXJsOiAnL2RhdGFiYXNlQ29uZi91cGRhdGUnLAogICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICBkYXRhOiB7IAogICAgICAgICAgICBpZDogdGhpcy5kYXRhYmFzZUluZm9Gb3JtLmRhdGFiYXNlSW5mb0lkLAogICAgICAgICAgICBob3N0OiB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0uaG9zdCwKICAgICAgICAgICAgcG9ydDogdGhpcy5kYXRhYmFzZUluZm9Gb3JtLnBvcnQsCiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udXNlcm5hbWUsCiAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ucGFzc3dvcmQsCiAgICAgICAgICAgIGNvZGU6IHRoaXMuZGF0YWJhc2VJbmZvRm9ybS5jb2RlCiAgICAgICAgICB9IAogICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBtZXNzYWdlOiAn5pu05paw5oiQ5YqfJwogICAgICAgICAgfSk7CgogICAgICAgICAgdGhpcy5kYXRhYmFzZUluZm9Gb3JtLnZpc2libGUgPSBmYWxzZTsKICAgICAgICAgIHRoaXMucmVmcmVzaERhdGEodGhpcy5kYXRhYmFzZUluZm9Gb3JtLmluZGV4KTsKCiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgIH0pCgogICAgICB9ZWxzZXsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udGl0bGUgPSAi5L+u5pS56YWN572uIjsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0uaXNVcGRhdGUgPSB0cnVlOwogICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvRm9ybS5ob3N0ID0gdGhpcy5jb250ZXh0TWVudS5ub2RlLmRhdGEuaG9zdDsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ucG9ydCA9IHRoaXMuY29udGV4dE1lbnUubm9kZS5kYXRhLnBvcnQ7CiAgICAgICAgdGhpcy5kYXRhYmFzZUluZm9Gb3JtLnVzZXJuYW1lID0gdGhpcy5jb250ZXh0TWVudS5ub2RlLmRhdGEudXNlcm5hbWU7CiAgICAgICAgdGhpcy5kYXRhYmFzZUluZm9Gb3JtLnBhc3N3b3JkID0gdGhpcy5jb250ZXh0TWVudS5ub2RlLmRhdGEucGFzc3dvcmQ7CiAgICAgICAgdGhpcy5kYXRhYmFzZUluZm9Gb3JtLnR5cGUgPSAiTXlzcWwiOwogICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvRm9ybS5jb2RlID0gdGhpcy5jb250ZXh0TWVudS5ub2RlLmRhdGEuY29kZTsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udmlzaWJsZSA9IHRydWU7CiAgICAgICAgdGhpcy5kYXRhYmFzZUluZm9Gb3JtLmluZGV4ID0gdGhpcy5jb250ZXh0TWVudS5pbmRleDsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0uZGF0YWJhc2VJbmZvSWQgPSB0aGlzLmNvbnRleHRNZW51Lm5vZGUuZGF0YS5pZDsKICAgICAgICB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ud2Vic2hlbGxJZCA9IHRoaXMuY29udGV4dE1lbnUubm9kZS5kYXRhLndlYnNoZWxsSWQ7CiAgICAgIH0KICAgIH0sCgogICAgY29udGV4dE1lbnVfYWRkRGF0YWJhc2VJbmZvKCl7CiAgICAgIHRoaXMuYWRkRGF0YWJhc2VJbmZvKGZhbHNlLHRoaXMuY29udGV4dE1lbnUuaXRlbSx0aGlzLmNvbnRleHRNZW51LmluZGV4KTsKICAgIH0sCgogICAgZGVsZXRlRGF0YWJhc2VJbmZvKCl7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuawuOS5heWIoOmZpOivpemFjee9riwg5piv5ZCm57un57utPycsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKCgpID0+IHsKCiAgICAgICAgcmVxdWVzdCh7CiAgICAgICAgICB1cmw6ICcvZGF0YWJhc2VDb25mL2RlbGV0ZUJ5SWQnLAogICAgICAgICAgbWV0aG9kOiAnZ2V0JywKICAgICAgICAgIHBhcmFtczogeyAKICAgICAgICAgICAgaWQ6dGhpcy5jb250ZXh0TWVudS5ub2RlLmRhdGEuaWQKICAgICAgICAgIH0gCiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIG1lc3NhZ2U6ICfliKDpmaTmiJDlip8nCiAgICAgICAgICB9KTsKCiAgICAgICAgICB0aGlzLnJlZnJlc2hEYXRhKHRoaXMuY29udGV4dE1lbnUuaW5kZXgpOwoKICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgfSkKCiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtojliKDpmaQnCiAgICAgICAgfSk7ICAgICAgICAgIAogICAgICB9KTsKICAgIH0sCgogICAgdGVzdENvbm5lY3Rpb24oKXsKICAgICAgcmVxdWVzdCh7CiAgICAgICAgdXJsOiAnL2RhdGFiYXNlQ29uZi90ZXN0Q29ubmVjdGlvbicsCiAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgZGF0YTogeyAKICAgICAgICAgIHdlYnNoZWxsSWQ6IHRoaXMuZGF0YWJhc2VJbmZvRm9ybS53ZWJzaGVsbElkLAogICAgICAgICAgaG9zdDogdGhpcy5kYXRhYmFzZUluZm9Gb3JtLmhvc3QsCiAgICAgICAgICBwb3J0OiB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0ucG9ydCwKICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLmRhdGFiYXNlSW5mb0Zvcm0udXNlcm5hbWUsCiAgICAgICAgICBwYXNzd29yZDogdGhpcy5kYXRhYmFzZUluZm9Gb3JtLnBhc3N3b3JkLAogICAgICAgICAgY29kZTogdGhpcy5kYXRhYmFzZUluZm9Gb3JtLmNvZGUKICAgICAgICB9IAogICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAKICAgICAgICBpZihyZXNwb25zZS5kYXRhKXsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIG1lc3NhZ2U6ICfov57mjqXmiJDlip8nCiAgICAgICAgICB9KTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiAnZXJyb3InLAogICAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5tZXNzYWdlCiAgICAgICAgICB9KTsgIAogICAgICAgIH0KCiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pCiAgICB9LAoKICAgIG5vZGVDbGljayhub2RlLGl0ZW0saW5kZXgpewogICAgICBpZihub2RlLmxldmVsID09IDEpIHsKICAgICAgICBpdGVtLmRhdGFiYXNlQ29uZklkID0gbm9kZS5kYXRhLmlkOwogICAgICAgIGl0ZW0uZGF0YWJhc2VDb25mID0gbm9kZS5kYXRhLm5hbWU7CiAgICAgIH1lbHNlIGlmKG5vZGUubGV2ZWwgPT0gMil7CiAgICAgICAgaXRlbS5kYXRhYmFzZUNvbmZJZCA9IG5vZGUucGFyZW50LmRhdGEuaWQ7CiAgICAgICAgaXRlbS5kYXRhYmFzZUNvbmYgPSBub2RlLnBhcmVudC5kYXRhLm5hbWU7CiAgICAgICAgaXRlbS5kYm5hbWUgPSBub2RlLmRhdGEubmFtZTsKICAgICAgfWVsc2UgaWYobm9kZS5sZXZlbCA9PSAzKXsKICAgICAgICBpdGVtLmRhdGFiYXNlQ29uZklkID0gbm9kZS5wYXJlbnQucGFyZW50LmRhdGEuaWQ7CiAgICAgICAgaXRlbS5kYXRhYmFzZUNvbmYgPSBub2RlLnBhcmVudC5wYXJlbnQuZGF0YS5uYW1lOwogICAgICAgIGl0ZW0uZGJuYW1lID0gbm9kZS5wYXJlbnQuZGF0YS5uYW1lOwogICAgICB9ZWxzZSBpZihub2RlLmxldmVsID09IDQpewogICAgICAgIGl0ZW0uZGF0YWJhc2VDb25mSWQgPSBub2RlLnBhcmVudC5wYXJlbnQucGFyZW50LmRhdGEuaWQ7CiAgICAgICAgaXRlbS5kYXRhYmFzZUNvbmYgPSBub2RlLnBhcmVudC5wYXJlbnQucGFyZW50LmRhdGEubmFtZTsKICAgICAgICBpdGVtLmRibmFtZSA9IG5vZGUucGFyZW50LnBhcmVudC5kYXRhLm5hbWU7CiAgICAgIH0KICAgIH0sCgogICAgZXhlY3V0ZVNRTChpdGVtKXsKICAgICAgaXRlbS5yZXN1bHRzID0gW1tdXTsKICAgICAgdGhpcy4kZm9yY2VVcGRhdGUoKTsKICAgICAgcmVxdWVzdCh7CiAgICAgICAgdXJsOiAnL2RhdGFiYXNlQ29uZi9leGVjdXRlU1FMJywKICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICBkYXRhOiB7IAogICAgICAgICAgaWQ6aXRlbS5kYXRhYmFzZUNvbmZJZCwKICAgICAgICAgIGRibmFtZTppdGVtLmRibmFtZSwKICAgICAgICAgIFNRTDppdGVtLlNRTCwKICAgICAgICAgIGxpbWl0Ok51bWJlcihpdGVtLmxpbWl0KSwKICAgICAgICB9IAogICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAKICAgICAgICBpdGVtLnJlc3VsdHMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCk7CgogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KQogICAgfQoKCiAgfSwKCiAgY3JlYXRlZCgpewogICAgdGhpcy5mZXRjaFdlYnNoZWxsRGF0YSgpOwogICAgdGhpcy5uYW1lID0gdGhpcy4kcm91dGUubmFtZTsKICAgIGlmKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCl7CiAgICAgIHRoaXMuc2VsZWN0V2Vic2hlbGxGb3JtLndlYnNoZWxsSWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQKICAgICAgdGhpcy5zZWxlY3RXZWJzaGVsbCh0cnVlKTsKICAgIH0KICB9LAoKICB3YXRjaDogewogICAgJHJvdXRlKHRvLCBmcm9tKSB7CiAgICAgIGlmKHRvLm5hbWUgPT0gdGhpcy5uYW1lKXsKICAgICAgICB0aGlzLmZldGNoV2Vic2hlbGxEYXRhKCk7CiAgICAgICAgaWYodGhpcy4kcm91dGUucGFyYW1zLmlkKXsKICAgICAgICAgIHRoaXMuc2VsZWN0V2Vic2hlbGxGb3JtLndlYnNoZWxsSWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQKICAgICAgICAgIHRoaXMuc2VsZWN0V2Vic2hlbGwodHJ1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKCiAgbW91bnRlZCgpewogICAgd2luZG93LnZ1ZSA9IHRoaXM7CiAgfSwKCn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiNA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/views/database","sourcesContent":["<template>\n  <el-container>\n    <el-main>\n      <el-tabs v-model=\"content.currentTabName\" type=\"card\" editable @edit=\"handleTabsEdit\">\n        <el-tab-pane\n          :key=\"item.name\"\n          v-for=\"item, index in content.tabs\"\n          :label=\"item.title\"\n          :name=\"item.name\"\n        >\n\n          <el-container>\n            <el-aside width=\"250px\" style=\"border:1px solid #e5e7ec;padding-top: 0px;\">\n              <el-button \n              v-if=\"item.empty\" \n              style=\"display:block;margin:10px auto 0px auto;\" \n              size=\"mini\" \n              icon=\"el-icon-plus\" \n              circle \n              @click=\"addDatabaseInfo(false,item,index)\"></el-button>\n              <el-tree\n                :props=\"el_tree_props\"\n                :load=\"(node, resolve) => loadNode(node, resolve, item)\"\n                ref=\"tree\"\n                node-key=\"nodeKey\"\n                lazy\n                @node-click=\"(object,node,component) => nodeClick(node,item,index)\"\n                @node-contextmenu=\"(event,object,node,component) => nodeRightClick(event,node,item,index)\">\n              </el-tree>\n            </el-aside>\n            <el-main style=\"padding-top: 0px;\">\n\n              <el-form :inline=\"true\">\n                <el-form-item label=\"数据库配置\">\n                  <el-input size=\"mini\" readonly v-model=\"item.databaseConf\" placeholder=\"数据库配置\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"数据库名\">\n                  <el-input size=\"mini\" readonly v-model=\"item.dbname\" placeholder=\"数据库名\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"数据量限制\">\n                  <el-select \n                    size=\"mini\" \n                    v-model=\"item.limit\" \n                    placeholder=\"数量\" \n                    style=\"width:100px\"\n                    filterable\n                    allow-create>\n                    <el-option value=\"100\"></el-option>\n                    <el-option label=\"无限制\" value=\"-1\"></el-option>\n                  </el-select>\n                </el-form-item>\n                <el-form-item>\n                  <el-button size=\"mini\" type=\"primary\" @click=\"executeSQL(item)\">执行</el-button>\n                </el-form-item>\n                <el-form-item>\n                  <el-button size=\"mini\" type=\"primary\" @click=\"item.SQL=''\">清空</el-button>\n                </el-form-item>\n              </el-form>\n\n              <el-input\n                type=\"textarea\"\n                :rows=\"10\"\n                placeholder=\"请输入SQL语句\"\n                v-model=\"item.SQL\">\n              </el-input>\n\n              <div\n                v-for=\"(result,index) in item.results\"\n                :key=\"index\">\n\n                <el-table\n                  :data=\"result\"\n                  max-height=\"300\"\n                  border\n                  resizable\n                  style=\"width: 100%;margin-top:20px;\">\n                  <el-table-column\n                    v-for=\"key in Object.keys( (JSON.stringify(result)==='[]')?{}:result[0] )\"\n                    :key=\"key\"\n\n                    :label=\"key\">\n                    <template slot-scope=\"scope\">\n                      {{ scope.row[key]}}\n                    </template>\n                  </el-table-column>\n                </el-table>\n\n              </div>\n\n            </el-main>\n          </el-container>\n\n\n        </el-tab-pane>\n      </el-tabs>\n      <el-empty v-if=\"content.tabs.length == 0\" description=\"未选择Webshell\"></el-empty>\n    </el-main>\n\n    <el-dialog title=\"选择数据\" :visible.sync=\"selectWebshellForm.visible\" width=\"40%\">\n      <el-form :model=\"selectWebshellForm\">\n        <el-form-item label=\"URL\" required>\n          <el-select v-model=\"selectWebshellForm.webshellId\" placeholder=\"请选择\" style=\"width:85%\">\n            <el-option\n              v-for=\"item in webshells\"\n              :key=\"item.id\"\n              :label=\"item.url\"\n              :value=\"item.id\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"selectWebshellForm.visible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"selectWebshell(true)\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog :title=\"databaseInfoForm.title\" :visible.sync=\"databaseInfoForm.visible\">\n      <el-form :model=\"databaseInfoForm\">\n        <el-form-item label=\"地址\" label-width=\"80px\" required>\n          <el-col :span=\"17\">\n            <el-input placeholder=\"地址\" v-model=\"databaseInfoForm.host\" autocomplete=\"off\" style=\"width:100%\"></el-input>\n          </el-col>\n          <el-col class=\"line\" :span=\"1\"><p style=\"text-align:center; display:block;margin:0px auto\">:</p></el-col>\n          <el-col :span=\"4\">\n            <el-input placeholder=\"端口\" v-model.number=\"databaseInfoForm.port\" autocomplete=\"off\" style=\"width:100%\"></el-input>\n          </el-col>\n        </el-form-item>\n        <el-form-item label=\"用户名\" label-width=\"80px\" required>\n          <el-col :span=\"22\">\n            <el-input placeholder=\"用户名\" v-model=\"databaseInfoForm.username\" autocomplete=\"off\" style=\"width:100%\"></el-input>\n          </el-col>\n        </el-form-item>\n        <el-form-item label=\"密码\" label-width=\"80px\" required>\n          <el-col :span=\"22\">\n            <el-input placeholder=\"密码\" v-model=\"databaseInfoForm.password\" autocomplete=\"off\" style=\"width:100%\"></el-input>\n          </el-col>\n        </el-form-item>\n        <el-form-item label=\"类型\" label-width=\"80px\" required>\n          <el-col :span=\"22\">\n            <el-select \n              v-model=\"databaseInfoForm.type\" \n              placeholder=\"类型\" \n              style=\"width:100%\">\n              <el-option value=\"Mysql\"></el-option>\n            </el-select>\n          </el-col>\n        </el-form-item>\n        <el-form-item label=\"编码\" label-width=\"80px\" required>\n          <el-col :span=\"22\">\n            <el-select \n              v-model=\"databaseInfoForm.code\" \n              placeholder=\"编码\" \n              style=\"width:100%\"\n              filterable\n              allow-create>\n              <el-option value=\"utf8\"></el-option>\n              <el-option value=\"gbk\"></el-option>\n            </el-select>\n          </el-col>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button icon=\"el-icon-connection\" @click=\"testConnection()\">测试连接</el-button>\n        <el-button @click=\"databaseInfoForm.visible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addOrUpdateDatabaseInfo()\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n    <div v-show=\"contextMenu.visible\">\n      <ul id=\"contextMenu\" :style=\"{left:contextMenu.left+'px',top:contextMenu.top+'px'}\" class=\"contextmenu\">\n        <li class=\"el-icon-edit\" @click=\"updateDatabaseInfo(false)\"> 编辑配置 </li>\n        <br>\n        <li class=\"el-icon-document-add\" @click=\"contextMenu_addDatabaseInfo\"> 添加配置 </li>\n        <br>\n        <li class=\"el-icon-delete\" @click=\"deleteDatabaseInfo\"> 删除配置 </li>\n      </ul>\n    </div>\n\n  </el-container>\n</template>\n\n<style>\n  .contextmenu {\n    border: 1px solid #ccc;\n    background: #fff;\n    z-index: 3000;\n    position: absolute;\n    list-style-type: none;\n    padding: 5px 0;\n    border-radius: 4px;\n    font-size: 14px;\n    color: #333;\n    box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, 0.2);\n  }\n  .contextmenu li {\n    margin: 0;\n    padding: 5px 10px;\n  }\n  .contextmenu li:hover {\n    background: #f2f2f2;\n    cursor: default;\n  }\n  .el-tree-node.is-expanded > .el-tree-node__children{\n    display: inline-block;\n  }\n</style>\n\n<script>\n  import request from '@/utils/request'\n\n  export default {\n    data() {\n      return {\n        contextMenu:{\n          visible: false,\n          top: 0,\n          left: 0,\n          height:0\n        },\n\n        databaseInfoForm:{\n          title: \"\",\n          isUpdate: false,\n          host: \"\",\n          port: 3306,\n          username: \"\",\n          password: \"\",\n          type: \"\",\n          code: \"\",\n          visible: false,\n          webshellId:null,\n          tab_index:null,\n        },\n\n        el_tree_props:{\n          label: 'name',\n          isLeaf: 'isleaf'\n        },\n\n        webshells: [\n          // {\n          //   id: 1,\n          //   url: \"http://qq.com/1.php\",\n          // }\n        ],\n\n        content:{\n          currentTabName: \"\",\n          tabIndex:0,\n\n          tabs:[\n          ],\n        },\n\n        selectWebshellForm:{\n          visible: false,\n          webshellId: null\n        }\n\n      }\n    },\n    methods: {\n      loadNode(node, resolve, item) {\n        if (node.level === 0) {   //返回数据库配置列表\n\n          request({\n            url: '/databaseConf/getByWebShellId',\n            method: 'get',\n            params: { id:item.webshellId } \n          }).then(response => {\n\n            let url = response.data.url;\n            let res = url.match(/https?:\\/\\/(.*)?\\//);\n            if(res){\n              item.title = res[1];\n            }else{\n              item.title = url;\n            }\n\n            const databaseInfos = response.data.databases;\n\n            let data = [];\n            databaseInfos.forEach(function(value,index) {\n              let tmp = {};\n              tmp[\"name\"] = value.username+\"@\"+value.host+\":\"+value.port;\n              tmp[\"id\"] = value.id;   //记录数据库配置id\n              tmp[\"nodeKey\"] = value.id;\n\n              tmp[\"host\"] = value.host;   //记录其他配置信息，供右键点击编辑一条配置时取用\n              tmp[\"port\"] = value.port;\n              tmp[\"username\"] = value.username;\n              tmp[\"password\"] = value.password;\n              tmp[\"code\"] = value.code;\n              tmp[\"webshellId\"] = item.webshellId;\n              data.push(tmp);\n            });\n\n            if(JSON.stringify(data)==='[]'){       //判断是否是空数组\n              item.empty = true;\n            }else{\n              item.empty = false;\n            }\n            this.$forceUpdate();\n\n            resolve(data);\n\n          }).catch(error => {\n            item.title = \"加载失败\";\n            console.log(error);\n          })\n\n        }\n\n        if (node.level === 1) {   //点击了某条数据库配置，应该返回数据库名列表\n          const databaseInfoId = node.data.id;  //数据库配置id\n\n          request({\n            url: '/databaseConf/getDatabases',\n            method: 'get',\n            params: { id:databaseInfoId } \n          }).then(response => {\n\n            const databases = response.data[0];\n\n            let data = [];\n            databases.forEach(function(value,index) {\n              let tmp ={};\n              tmp[\"name\"] = Object.values(value)[0];  //显示的名称、数据库名\n              tmp[\"id\"] = databaseInfoId;   //记录数据库配置id\n              tmp[\"nodeKey\"] = databaseInfoId+\".\"+Object.values(value)[0];\n              data.push(tmp);\n            });\n\n            resolve(data);\n            node.loaded = false;  //设置loaded为false，这样每次折叠后再展开时会重新请求后端获取最新数据\n            node.isLeaf = false;\n\n          }).catch(error => {\n            resolve([]);  //resolve空数组后，会变成叶子节点，下面设置回非叶子节点，并且设置为非展开未加载，让用户可以重新点击加载\n            node.expanded = false;\n            node.loaded = false;\n            node.isLeaf = false;\n            console.log(error);\n          })\n\n        }\n\n        if (node.level === 2) {   //点击了某数据库，应该返回表名列表\n          const databaseInfoId = node.data.id;  //数据库配置id\n          const dbname = node.data.name;  //数据库名\n\n          request({\n            url: '/databaseConf/getTables',\n            method: 'get',\n            params: { \n              id:databaseInfoId,\n              dbname:dbname\n            } \n          }).then(response => {\n\n            const tables = response.data[0];\n\n            let data = [];\n            tables.forEach(function(value,index) {\n              let tmp ={};\n              tmp[\"name\"] = Object.values(value)[0];  //显示的名称、表名\n              tmp[\"id\"] = databaseInfoId;   //记录数据库配置id\n              tmp[\"dbname\"] = dbname;   //记录数据库名\n              tmp[\"nodeKey\"] = \"3.\"+databaseInfoId+\".\"+dbname+\".\"+Object.values(value)[0];\n              data.push(tmp);\n            });\n\n            resolve(data);\n            node.loaded = false;  //设置loaded为false，这样每次折叠后再展开时会重新请求后端获取最新数据\n            node.isLeaf = false;\n\n          }).catch(error => {\n            resolve([]);  //resolve空数组后，会变成叶子节点，下面设置回非叶子节点，并且设置为非展开未加载，让用户可以重新点击加载\n            node.expanded = false;\n            node.loaded = false;\n            node.isLeaf = false;\n            console.log(error);\n          })\n\n        }\n\n        if (node.level === 3) {   //点击了某表，应该返回列名列表\n          const databaseInfoId = node.data.id;  //数据库配置id\n          const dbname = node.data.dbname;  //数据库名\n          const table = node.data.name;  //表名\n\n          request({\n            url: '/databaseConf/getColumns',\n            method: 'get',\n            params: { \n              id:databaseInfoId,\n              dbname:dbname,\n              table:table\n            } \n          }).then(response => {\n\n            const columns = response.data[0];\n\n            let data = [];\n            columns.forEach(function(value,index) {\n              let tmp ={};\n              tmp[\"name\"] = value.Field+\" ( \"+value.Type+\" ) \";  //显示的名称\n              tmp[\"id\"] = databaseInfoId;   //记录数据库配置id\n              tmp[\"dbname\"] = dbname;   //记录数据库名\n              tmp[\"table\"] = table;   //记录表名\n              tmp[\"column\"] = value.Field;  //记录列名\n              tmp[\"isleaf\"] = true; //表示是叶子节点\n              data.push(tmp);\n            });\n\n            resolve(data);\n            node.loaded = false;  //设置loaded为false，这样每次折叠后再展开时会重新请求后端获取最新数据\n            node.isLeaf = false;\n\n          }).catch(error => {\n            resolve([]);  //resolve空数组后，会变成叶子节点，下面设置回非叶子节点，并且设置为非展开未加载，让用户可以重新点击加载\n            node.expanded = false;\n            node.loaded = false;\n            node.isLeaf = false;\n            console.log(error);\n          })\n\n        }\n      },\n\n      test(){\n        console.log(1);\n      },\n\n      handleTabsEdit(targetName, action) {\n        if (action === 'add') {\n          this.selectWebshell(false);\n        }\n        if (action === 'remove') {\n          let tabs = this.content.tabs;\n          let activeName = this.content.currentTabName;\n          if (activeName === targetName) {\n            tabs.forEach((tab, index) => {\n              if (tab.name === targetName) {\n                let nextTab = tabs[index + 1] || tabs[index - 1];\n                if (nextTab) {\n                  activeName = nextTab.name;\n                }\n              }\n            });\n          }\n          \n          this.content.currentTabName = activeName;\n          this.content.tabs = tabs.filter(tab => tab.name !== targetName);\n        }\n      },\n\n      fetchWebshellData(){\n        request({\n          url: '/webshell/findAll',\n          method: 'get',\n        }).then(response => {\n          this.webshells = response.data;\n        }).catch(error => {\n          console.log(error);\n        })\n      },\n\n      selectWebshell(isAddTab){\n        if(isAddTab){\n          this.selectWebshellForm.visible = false;\n          let newTabName = ++this.content.tabIndex + '';\n          let webshellId = this.selectWebshellForm.webshellId;\n\n          let index = this.content.tabs.push({\n            title: \"加载中...\",\n            name: newTabName,\n            webshellId:webshellId,\n            limit:100,\n            databaseConf:\"\",\n            databaseConfId:0,\n            dbname:\"\",\n          })-1;\n          this.content.currentTabName = newTabName;\n\n        }else{\n          this.selectWebshellForm.visible = true;\n        }\n      },\n\n      addDatabaseInfo(isSubmit,item,index){\n        if(isSubmit){\n          request({\n            url: '/databaseConf/add',\n            method: 'post',\n            data: { \n              webshellId:this.databaseInfoForm.webshellId,\n              host:this.databaseInfoForm.host,\n              port:this.databaseInfoForm.port,\n              username:this.databaseInfoForm.username,\n              password:this.databaseInfoForm.password,\n              code:this.databaseInfoForm.code,\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '添加成功'\n            });\n\n            this.refreshData(this.databaseInfoForm.tab_index);\n            this.databaseInfoForm.visible = false;\n\n          }).catch(error => {\n            console.log(error);\n          })\n        }else{\n          this.databaseInfoForm.title = \"添加配置\";\n          this.databaseInfoForm.isUpdate = false;\n          this.databaseInfoForm.host = \"\";\n          this.databaseInfoForm.port = 3306;\n          this.databaseInfoForm.username = \"\";\n          this.databaseInfoForm.password = \"\";\n          this.databaseInfoForm.type = \"Mysql\";\n          this.databaseInfoForm.code = \"utf8\";\n          this.databaseInfoForm.visible = true;\n\n          this.databaseInfoForm.webshellId = item.webshellId;\n          this.databaseInfoForm.tab_index = index;\n        }\n      },\n\n      addOrUpdateDatabaseInfo(){\n        if(this.databaseInfoForm.isUpdate){\n          this.updateDatabaseInfo(true);\n        }else{\n          this.addDatabaseInfo(true,null,null);\n        }\n      },\n\n      refreshData(index){\n        this.$refs.tree[index].root.loaded = false;\n        this.$refs.tree[index].root.expanded = false;\n        this.$refs.tree[index].root.expand();\n      },\n\n      nodeRightClick(event,node,item,index){\n        this.closeMenu();\n        if (node.level == 1){\n          event.preventDefault();\n\n          const offsetLeft = this.$el.getBoundingClientRect().left\n          const left = event.clientX - offsetLeft;\n          this.contextMenu.left = left;\n          if ( (document.body.scrollHeight - event.pageY) < this.contextMenu.height ){\n            this.contextMenu.top = document.body.scrollHeight - this.contextMenu.height-70;\n          }else{\n            this.contextMenu.top = event.pageY - 60;\n          }\n          this.contextMenu.visible = true;\n\n          this.contextMenu.item = item;     //记录item和index还有node,在点击菜单中的选项时需要用到这两个值\n          this.contextMenu.index = index;\n          this.contextMenu.node = node;\n\n          document.body.addEventListener('click', this.closeMenu);\n        }\n      },\n\n      closeMenu() {\n        this.contextMenu.visible = false;\n        document.body.removeEventListener('click', this.closeMenu);\n      },\n\n      updateDatabaseInfo(isSubmit){\n        if(isSubmit){\n\n          request({\n            url: '/databaseConf/update',\n            method: 'post',\n            data: { \n              id: this.databaseInfoForm.databaseInfoId,\n              host: this.databaseInfoForm.host,\n              port: this.databaseInfoForm.port,\n              username: this.databaseInfoForm.username,\n              password: this.databaseInfoForm.password,\n              code: this.databaseInfoForm.code\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '更新成功'\n            });\n\n            this.databaseInfoForm.visible = false;\n            this.refreshData(this.databaseInfoForm.index);\n\n          }).catch(error => {\n            console.log(error);\n          })\n\n        }else{\n          this.databaseInfoForm.title = \"修改配置\";\n          this.databaseInfoForm.isUpdate = true;\n          this.databaseInfoForm.host = this.contextMenu.node.data.host;\n          this.databaseInfoForm.port = this.contextMenu.node.data.port;\n          this.databaseInfoForm.username = this.contextMenu.node.data.username;\n          this.databaseInfoForm.password = this.contextMenu.node.data.password;\n          this.databaseInfoForm.type = \"Mysql\";\n          this.databaseInfoForm.code = this.contextMenu.node.data.code;\n          this.databaseInfoForm.visible = true;\n          this.databaseInfoForm.index = this.contextMenu.index;\n          this.databaseInfoForm.databaseInfoId = this.contextMenu.node.data.id;\n          this.databaseInfoForm.webshellId = this.contextMenu.node.data.webshellId;\n        }\n      },\n\n      contextMenu_addDatabaseInfo(){\n        this.addDatabaseInfo(false,this.contextMenu.item,this.contextMenu.index);\n      },\n\n      deleteDatabaseInfo(){\n        this.$confirm('此操作将永久删除该配置, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n\n          request({\n            url: '/databaseConf/deleteById',\n            method: 'get',\n            params: { \n              id:this.contextMenu.node.data.id\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '删除成功'\n            });\n\n            this.refreshData(this.contextMenu.index);\n\n          }).catch(error => {\n            console.log(error);\n          })\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });          \n        });\n      },\n\n      testConnection(){\n        request({\n          url: '/databaseConf/testConnection',\n          method: 'post',\n          data: { \n            webshellId: this.databaseInfoForm.webshellId,\n            host: this.databaseInfoForm.host,\n            port: this.databaseInfoForm.port,\n            username: this.databaseInfoForm.username,\n            password: this.databaseInfoForm.password,\n            code: this.databaseInfoForm.code\n          } \n        }).then(response => {\n          \n          if(response.data){\n            this.$message({\n              type: 'success',\n              message: '连接成功'\n            });\n          }else{\n            this.$message({\n              type: 'error',\n              message: response.message\n            });  \n          }\n\n        }).catch(error => {\n          console.log(error);\n        })\n      },\n\n      nodeClick(node,item,index){\n        if(node.level == 1) {\n          item.databaseConfId = node.data.id;\n          item.databaseConf = node.data.name;\n        }else if(node.level == 2){\n          item.databaseConfId = node.parent.data.id;\n          item.databaseConf = node.parent.data.name;\n          item.dbname = node.data.name;\n        }else if(node.level == 3){\n          item.databaseConfId = node.parent.parent.data.id;\n          item.databaseConf = node.parent.parent.data.name;\n          item.dbname = node.parent.data.name;\n        }else if(node.level == 4){\n          item.databaseConfId = node.parent.parent.parent.data.id;\n          item.databaseConf = node.parent.parent.parent.data.name;\n          item.dbname = node.parent.parent.data.name;\n        }\n      },\n\n      executeSQL(item){\n        item.results = [[]];\n        this.$forceUpdate();\n        request({\n          url: '/databaseConf/executeSQL',\n          method: 'post',\n          data: { \n            id:item.databaseConfId,\n            dbname:item.dbname,\n            SQL:item.SQL,\n            limit:Number(item.limit),\n          } \n        }).then(response => {\n          \n          item.results = response.data;\n          this.$forceUpdate();\n\n        }).catch(error => {\n          console.log(error);\n        })\n      }\n\n\n    },\n\n    created(){\n      this.fetchWebshellData();\n      this.name = this.$route.name;\n      if(this.$route.params.id){\n        this.selectWebshellForm.webshellId = this.$route.params.id\n        this.selectWebshell(true);\n      }\n    },\n\n    watch: {\n      $route(to, from) {\n        if(to.name == this.name){\n          this.fetchWebshellData();\n          if(this.$route.params.id){\n            this.selectWebshellForm.webshellId = this.$route.params.id\n            this.selectWebshell(true);\n          }\n        }\n      }\n    },\n\n    mounted(){\n      window.vue = this;\n    },\n\n  };\n</script>"]}]}