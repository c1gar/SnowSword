{"remainingRequest":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/src/views/dashboard/index.vue?vue&type=style&index=0&id=106c86ed&lang=css","dependencies":[{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/src/views/dashboard/index.vue","mtime":1671438929000},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/css-loader/dist/cjs.js","mtime":1715570462613},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1715570461645},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/postcss-loader/src/index.js","mtime":1715570460320},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/cache-loader/dist/cjs.js","mtime":1715570484549},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/vue-loader/lib/index.js","mtime":1715570461633}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmVsLWFzaWRlIHsKICBwYWRkaW5nLXRvcDogMjBweDsKICBwYWRkaW5nLXJpZ2h0OiAyMHB4Owp9CgouY29udGV4dG1lbnUgewogIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7CiAgYmFja2dyb3VuZDogI2ZmZjsKICB6LWluZGV4OiAzMDAwOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBsaXN0LXN0eWxlLXR5cGU6IG5vbmU7CiAgcGFkZGluZzogNXB4IDA7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIGZvbnQtc2l6ZTogMTRweDsKICBjb2xvcjogIzMzMzsKICBib3gtc2hhZG93OiAycHggMnB4IDNweCAwIHJnYmEoMCwgMCwgMCwgMC4yKTsKfQouY29udGV4dG1lbnUgbGkgewogIG1hcmdpbjogMDsKICBwYWRkaW5nOiA1cHggMTBweDsKfQouY29udGV4dG1lbnUgbGk6aG92ZXIgewogIGJhY2tncm91bmQ6ICNmMmYyZjI7CiAgY3Vyc29yOiBkZWZhdWx0Owp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgJA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/dashboard","sourcesContent":["<template>\n  <el-container>\n    <el-main>\n      <el-table\n        @row-contextmenu=\"webshellRightClick\"\n        border\n        resizable\n        :data=\"webshells\"\n        highlight-current-row\n        style=\"width: 100%\">\n        <el-table-column\n          property=\"url\"\n          label=\"URL地址\">\n        </el-table-column>\n        <el-table-column\n          property=\"info.ip_address\"\n          label=\"IP地址\"\n          width=\"130px\">\n        </el-table-column>\n        <el-table-column\n          property=\"info.address\"\n          label=\"物理位置\">\n        </el-table-column>\n        <el-table-column\n          property=\"note\"\n          label=\"网站备注\">\n        </el-table-column>\n        <el-table-column\n          property=\"create_time\"\n          label=\"创建时间\"\n          width=\"160px\">\n        </el-table-column>\n        <el-table-column\n          property=\"update_time\"\n          width=\"160px\"\n          label=\"更新时间\">\n        </el-table-column>\n        <template slot=\"empty\">\n          <el-button size=\"mini\" icon=\"el-icon-plus\" circle @click=\"addWebshell(false)\"></el-button>\n        </template>\n      </el-table>\n    </el-main>\n\n    <el-aside width=\"200px\">\n      <el-table\n        @row-click=\"changeCategory\"\n        @row-contextmenu=\"categoryRightClick\"\n        border\n        :data=\"categories\"\n        highlight-current-row\n        style=\"width: 100%\">\n        <el-table-column\n          label=\"分类\">\n          <template slot-scope=\"scope\">\n            <i class=\"el-icon-folder\"></i>\n            <span style=\"margin-left: 10px\">{{ scope.row.name }}</span> <el-tag size=\"mini\" style=\"float:right\">{{ scope.row.webshellCount }}</el-tag>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-aside>\n\n    <div v-show=\"contextMenu.webshell.visible\">\n      <ul id=\"webshellContextMenu\" :style=\"{left:contextMenu.webshell.left+'px',top:contextMenu.webshell.top+'px'}\" class=\"contextmenu\">\n        <li class=\"el-icon-tickets\" @click=\"openOverview()\"> 信息概览 </li>\n        <br>\n        <li class=\"el-icon-monitor\" @click=\"openTerminal()\"> 虚拟终端 </li>\n        <br>\n        <li class=\"el-icon-files\" @click=\"openFilemanager()\"> 文件管理 </li>\n        <br>\n        <li class=\"el-icon-coin\" @click=\"openDatabase()\"> 数据操作 </li>\n        <br>\n        <li class=\"el-icon-view\" @click=\"openWebsite\"> 浏览网站 </li>\n        <br><br>\n        <li class=\"el-icon-document-add\" @click=\"addWebshell(false)\"> 添加数据 </li>\n        <br>\n        <li class=\"el-icon-edit\" @click=\"updateWebshell(false)\"> 编辑数据 </li>\n        <br>\n        <li class=\"el-icon-delete\" @click=\"deleteWebshell\"> 删除数据 </li>\n        <br><br>\n        <li class=\"el-icon-folder-checked\" @click=\"addToCategory(false)\"> 设置分类 </li>\n        <br>\n        <li class=\"el-icon-folder-delete\" @click=\"removeFromCategory\"> 移出分类 </li>\n      </ul>\n    </div>\n\n    <div v-show=\"contextMenu.category.visible\">\n      <ul id=\"categoryContextMenu\" :style=\"{left:contextMenu.category.left+'px',top:contextMenu.category.top+'px'}\" class=\"contextmenu\">\n        <li class=\"el-icon-edit\" @click=\"renameCategory\"> 重命名 </li>\n        <br>\n        <li class=\"el-icon-folder-add\" @click=\"addCategory\"> 添加分类 </li>\n        <br>\n        <li class=\"el-icon-delete\" @click=\"deleteCategory\"> 删除分类 </li>\n      </ul>\n    </div>\n\n\n    <el-dialog :title=\"webshellForm.title\" :visible.sync=\"webshellForm.visible\">\n      <el-form :model=\"webshellForm\">\n        <el-form-item label=\"URL地址\" label-width=\"120px\" required>\n          <el-input v-model=\"webshellForm.url\" autocomplete=\"off\" style=\"width:90%\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"连接密码\" label-width=\"120px\" required>\n          <el-input v-model=\"webshellForm.password\" autocomplete=\"off\" style=\"width:90%\" show-password></el-input>\n        </el-form-item>\n        <el-form-item label=\"网站备注\" label-width=\"120px\">\n          <el-input\n            type=\"textarea\"\n            style=\"width:90%\"\n            :autosize=\"{ minRows: 2, maxRows: 4}\"\n            v-model=\"webshellForm.note\">\n          </el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button icon=\"el-icon-connection\" @click=\"testConnection\">测试连接</el-button>\n        <el-button @click=\"webshellForm.visible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addOrUpdateWebshell()\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"设置分类\" :visible.sync=\"categoryForm.visible\" width=\"40%\">\n      <el-form :model=\"categoryForm\">\n        <el-form-item label=\"分类名\" required>\n          <el-select v-model=\"categoryForm.categoryId\" placeholder=\"请选择\" style=\"width:85%\">\n            <el-option\n              v-for=\"item in categories\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"categoryForm.visible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addToCategory(true)\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n  </el-container>\n</template>\n\n\n<style>\n  .el-aside {\n    padding-top: 20px;\n    padding-right: 20px;\n  }\n\n  .contextmenu {\n    border: 1px solid #ccc;\n    background: #fff;\n    z-index: 3000;\n    position: absolute;\n    list-style-type: none;\n    padding: 5px 0;\n    border-radius: 4px;\n    font-size: 14px;\n    color: #333;\n    box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, 0.2);\n  }\n  .contextmenu li {\n    margin: 0;\n    padding: 5px 10px;\n  }\n  .contextmenu li:hover {\n    background: #f2f2f2;\n    cursor: default;\n  }\n</style>\n\n<script>\n  import request from '@/utils/request'\n  import { Loading } from 'element-ui';\n\n  export default {\n    data() {\n      return {\n        contextMenu:{\n          webshell: {\n            visible: false,\n            top: 0,\n            left: 0,\n            currentId: 0,\n            current:null,\n            height:0\n          },\n          category: {\n            visible: false,\n            top: 0,\n            left: 0,\n            currentId: 0,\n            current:null,\n            height:0\n          },\n        },\n\n\n        webshells: [\n          // {\n          // id: 1,\n          // url: 'http://qq.com/1.php',\n          // info: {\n          //   ip_address: '203.205.254.157',\n          //   address: '香港特别行政区  腾讯云 数据中心',\n          // },\n          // note: '备注信息',\n          // create_time: '2022-01-09 15:04:13',\n          // update_time: '2022-01-09 15:04:13',\n          // }, \n        ],\n\n        categories: [\n          // {\n          // id: 1,\n          // name: \"分类一\"\n          // }\n        ],\n\n        currentCategoryId:0,\n\n        webshellForm:{\n          visible:false,\n          title:'',\n          isUpdate:false,\n\n          url:'',\n          password:'',\n          note:''\n        },\n\n        categoryForm:{\n          visible:false,\n          categoryId:0\n        }\n\n      }\n    },\n\n    methods: {\n      categoryRightClick(row, column, event) {\n        event.preventDefault();\n        this.closeMenu();\n\n        const offsetLeft = this.$el.getBoundingClientRect().left\n        const left = event.clientX - offsetLeft;\n        this.contextMenu.category.left = left;\n        if ( (document.body.scrollHeight - event.pageY) < this.contextMenu.category.height ){\n          this.contextMenu.category.top = document.body.scrollHeight - this.contextMenu.category.height-70;\n        }else{\n          this.contextMenu.category.top = event.pageY - 60;\n        }\n        this.contextMenu.category.visible = true;\n\n        this.contextMenu.category.currentId = row.id;\n        this.contextMenu.category.current = row;\n\n        document.body.addEventListener('click', this.closeMenu);\n      },\n\n      webshellRightClick(row, column, event) {\n        event.preventDefault();\n        this.closeMenu();\n        \n        const offsetLeft = this.$el.getBoundingClientRect().left\n        const left = event.clientX - offsetLeft;\n        this.contextMenu.webshell.left = left;\n        if ( (document.body.scrollHeight - event.pageY) < this.contextMenu.webshell.height ){\n          this.contextMenu.webshell.top = document.body.scrollHeight - this.contextMenu.webshell.height-70;\n        }else{\n          this.contextMenu.webshell.top = event.pageY - 60;\n        }\n        this.contextMenu.webshell.visible = true;\n        \n        this.contextMenu.webshell.currentId = row.id;\n        this.contextMenu.webshell.current = row;\n\n        document.body.addEventListener('click', this.closeMenu);\n      },\n\n      closeMenu() {\n        this.contextMenu.webshell.visible = false;\n        this.contextMenu.category.visible = false;\n        document.body.removeEventListener('click', this.closeMenu);\n      },\n\n      fetchWebshellData(categoryId){\n        if(categoryId){\n          request({\n            url: '/webshell/getByCategoryId',\n            method: 'get',\n            params: { categoryId:categoryId } \n          }).then(response => {\n            this.webshells = response.data;\n          }).catch(error => {\n            console.log(error);\n          })\n        }else{\n          request({\n            url: '/webshell/findAll',\n            method: 'get',\n          }).then(response => {\n            this.webshells = response.data;\n          }).catch(error => {\n            console.log(error);\n          })\n        }\n      },\n\n      fetchCategoryData(){\n        request({\n          url: '/category/findAll',\n          method: 'get',\n        }).then(response => {\n          this.categories = response.data;\n        }).catch(error => {\n          console.log(error);\n        })\n      },\n\n      changeCategory(row){\n        this.fetchWebshellData(row.id);\n        this.currentCategoryId = row.id;\n      },\n\n      renameCategory(){\n\n        this.$prompt('请输入分类名', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n        }).then(({ value }) => {\n\n          request({\n            url: '/category/renameById',\n            method: 'get',\n            params: { \n              categoryId:this.contextMenu.category.currentId,\n              categoryName:value\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '修改成功'\n            });\n\n            this.refreshData();\n\n          }).catch(error => {\n            console.log(error);\n          })\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '取消输入'\n          });       \n        });\n\n      },\n\n      refreshData(){\n        this.fetchCategoryData();\n        this.fetchWebshellData(this.currentCategoryId);\n      },\n\n      addCategory(){\n\n        this.$prompt('请输入分类名', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n        }).then(({ value }) => {\n\n          request({\n            url: '/category/add',\n            method: 'post',\n            data: { \n              name:value\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '添加成功'\n            });\n\n            this.refreshData();\n\n          }).catch(error => {\n            console.log(error);\n          })\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '取消输入'\n          });       \n        });\n\n      },\n\n      deleteCategory(){\n\n        this.$confirm('此操作将永久删除该分类, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n\n          request({\n            url: '/category/deleteById',\n            method: 'get',\n            params: { \n              id:this.contextMenu.category.currentId\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '删除成功'\n            });\n\n            if(this.currentCategoryId == this.contextMenu.category.currentId){\n              this.currentCategoryId = 0;\n            }\n            this.refreshData();\n\n          }).catch(error => {\n            console.log(error);\n          })\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });          \n        });\n\n      },\n\n      openWebsite(){\n        var url = this.contextMenu.webshell.current.url;\n        var patt = /https?:\\/\\/.*?\\//\n        var host = url.match(patt)[0];\n        window.open(host,\"_blank\");\n      },\n\n      addOrUpdateWebshell(){\n        if(this.webshellForm.isUpdate){\n          this.updateWebshell(true);\n        }else{\n          this.addWebshell(true);\n        }\n      },\n\n      addWebshell(isSubmit){\n        if(isSubmit){\n          let loadingInstance = Loading.service();\n\n          request({\n            url: '/webshell/add',\n            method: 'post',\n            data: { \n              url:this.webshellForm.url,\n              password:this.webshellForm.password,\n              note:this.webshellForm.note\n            } \n          }).then(response => {\n            \n            var webshellId = response.data.id;\n            var categoryId = this.currentCategoryId;\n            if(categoryId){\n\n              request({\n                url: '/category/addWebshellById',\n                method: 'get',\n                params: { \n                  webshellId:webshellId,\n                  categoryId:categoryId\n                } \n              }).then(response => {\n                \n                this.$message({\n                  type: 'success',\n                  message: '添加成功'\n                });\n\n                this.webshellForm.visible = false;\n                this.refreshData();\n\n                loadingInstance.close();\n              }).catch(error => {\n                console.log(error);\n\n                loadingInstance.close();\n              })\n\n            }else{\n              this.$message({\n                type: 'success',\n                message: '添加成功'\n              });\n\n              this.webshellForm.visible = false;\n              this.refreshData();\n              loadingInstance.close();\n            }\n\n          }).catch(error => {\n            loadingInstance.close();\n            console.log(error);\n          })\n        }else{\n          this.webshellForm.title = \"添加数据\";\n          this.webshellForm.isUpdate = false;\n          this.webshellForm.url = \"\";\n          this.webshellForm.password = \"\";\n          this.webshellForm.note = \"\";\n          this.webshellForm.visible = true;\n        }\n      },\n\n      updateWebshell(isSubmit){\n        if(isSubmit){\n          let loadingInstance = Loading.service();\n\n          request({\n            url: '/webshell/update',\n            method: 'post',\n            data: { \n              id:this.contextMenu.webshell.current.id,\n              url:this.webshellForm.url,\n              password:this.webshellForm.password,\n              note:this.webshellForm.note\n            } \n          }).then(response => {\n            loadingInstance.close();\n            this.$message({\n              type: 'success',\n              message: '更新成功'\n            });\n\n            this.webshellForm.visible = false;\n            this.refreshData();\n\n          }).catch(error => {\n            loadingInstance.close();\n            console.log(error);\n          })\n\n        }else{\n          this.webshellForm.title = \"编辑数据\";\n          this.webshellForm.isUpdate = true;\n          this.webshellForm.url = this.contextMenu.webshell.current.url;\n          this.webshellForm.password = this.contextMenu.webshell.current.password;\n          this.webshellForm.note = this.contextMenu.webshell.current.note;\n          this.webshellForm.visible = true;\n        }\n      },\n\n      deleteWebshell(){\n\n        this.$confirm('此操作将永久删除该数据, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n\n          request({\n            url: '/webshell/deleteById',\n            method: 'get',\n            params: { \n              id:this.contextMenu.webshell.current.id\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '删除成功'\n            });\n\n            this.refreshData();\n\n          }).catch(error => {\n            console.log(error);\n          })\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });          \n        });\n\n      },\n\n      addToCategory(isSubmit){\n        if(isSubmit){\n          var categoryId = this.categoryForm.categoryId;\n          var webshellId = this.contextMenu.webshell.current.id;\n          if(!categoryId){\n            this.categoryForm.visible = false;\n            return;\n          }\n\n          request({\n            url: '/category/addWebshellById',\n            method: 'get',\n            params: { \n              webshellId:webshellId,\n              categoryId:categoryId\n            } \n          }).then(response => {\n            \n            this.$message({\n              type: 'success',\n              message: '设置成功'\n            });\n\n            this.categoryForm.visible = false;\n            this.refreshData();\n\n          }).catch(error => {\n            console.log(error);\n          })\n\n        }else{\n          this.categoryForm.visible = true;\n        }\n      },\n\n      removeFromCategory(){\n        var categoryId = this.currentCategoryId;\n        var webshellId = this.contextMenu.webshell.current.id;\n\n        if(!categoryId){\n          this.$message({\n            type: 'warning',\n            message: '不能从\"全部数据\"分类中移出'\n          });\n          return;\n        }\n\n        request({\n          url: '/category/removeWebshellById',\n          method: 'get',\n          params: { \n            webshellId:webshellId,\n            categoryId:categoryId\n          } \n        }).then(response => {\n          \n          this.$message({\n            type: 'success',\n            message: '移出成功'\n          });\n\n          this.refreshData();\n\n        }).catch(error => {\n          console.log(error);\n        })\n\n      },\n\n      testConnection(){\n\n        request({\n          url: '/webshell/testConnection',\n          method: 'post',\n          data: { \n            url:this.webshellForm.url,\n            password:this.webshellForm.password,\n          } \n        }).then(response => {\n          if(response.data){\n            this.$message({\n              type: 'success',\n              message: '连接成功'\n            });\n          }else{\n            this.$message({\n              type: 'error',\n              message: '连接失败'\n            });\n          }\n\n        }).catch(error => {\n          console.log(error);\n        })\n      },\n\n      openOverview() {\n        this.$router.push({\n          name : 'Overview',\n          params : {\n            id : this.contextMenu.webshell.current.id\n          }\n        });\n      },\n\n      openTerminal() {\n        this.$router.push({\n          name : 'Terminal',\n          params : {\n            id : this.contextMenu.webshell.current.id\n          }\n        });\n      },\n\n      openDatabase() {\n        this.$router.push({\n          name : 'Database',\n          params : {\n            id : this.contextMenu.webshell.current.id\n          }\n        });\n      },\n\n      openFilemanager(){\n        this.$router.push({\n          name : 'FileManager',\n          params : {\n            id : this.contextMenu.webshell.current.id\n          }\n        });\n      }\n\n    },\n\n    created(){\n      this.fetchWebshellData();\n      this.fetchCategoryData();\n\n      this.contextMenu.webshell.visible = true;\n      this.contextMenu.category.visible = true;\n    },\n\n    mounted(){\n      this.contextMenu.webshell.height = document.getElementById(\"webshellContextMenu\").clientHeight;\n      this.contextMenu.category.height = document.getElementById(\"categoryContextMenu\").clientHeight;\n      this.contextMenu.webshell.visible = false;\n      this.contextMenu.category.visible = false;\n    }\n\n  }\n</script>"]}]}