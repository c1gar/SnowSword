{"remainingRequest":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/babel-loader/lib/index.js!/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/src/views/filemanager/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/src/views/filemanager/index.vue","mtime":1671438929000},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/babel.config.js","mtime":1671438929000},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/cache-loader/dist/cjs.js","mtime":1715570484549},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/babel-loader/lib/index.js","mtime":1715570465906},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/cache-loader/dist/cjs.js","mtime":1715570484549},{"path":"/Users/cigar/Downloads/SnowSword-main/FrontEnd/snowsword/node_modules/vue-loader/lib/index.js","mtime":1715570461633}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwoKaW1wb3J0IHJlcXVlc3QgZnJvbSAnQC91dGlscy9yZXF1ZXN0JzsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlbF90cmVlX3Byb3BzOiB7CiAgICAgICAgbGFiZWw6ICduYW1lJywKICAgICAgICBpc0xlYWY6ICdpc19sZWFmJwogICAgICB9LAogICAgICB3ZWJzaGVsbHM6IFtdLAogICAgICBjb250ZW50OiB7CiAgICAgICAgY3VycmVudFRhYk5hbWU6ICIxIiwKICAgICAgICB0YWJJbmRleDogMSwKICAgICAgICB0YWJzOiBbXQogICAgICB9LAogICAgICBzZWxlY3RXZWJzaGVsbEZvcm06IHsKICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICB3ZWJzaGVsbElkOiBudWxsCiAgICAgIH0KICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2FkTm9kZTogZnVuY3Rpb24gbG9hZE5vZGUobm9kZSwgcmVzb2x2ZSwgaXRlbSkgewogICAgICB2YXIgcGF0aDsKICAgICAgaWYgKG5vZGUubGV2ZWwgPT09IDApIHsKICAgICAgICBwYXRoID0gIiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGF0aCA9IG5vZGUuZGF0YS5yZWFscGF0aDsKICAgICAgfQogICAgICByZXF1ZXN0KHsKICAgICAgICB1cmw6ICcvd2Vic2hlbGwvbG9hZEZpbGVzQnlJZCcsCiAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgZGF0YTogewogICAgICAgICAgaWQ6IGl0ZW0ud2Vic2hlbGxJZCwKICAgICAgICAgIHBhdGg6IHBhdGgKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTsKICAgICAgICBub2RlLmxvYWRlZCA9IGZhbHNlOyAvL+WxleW8gOaWh+S7tuWkueWQju+8jOS+neeEtuiuvue9rmxvYWRlZOS4umZhbHNl77yM6L+Z5qC36YeN5paw5bGV5byA5pe25omN5Lya5YaN5qyh6K+35rGC5ZCO56uv77yM6I635Y+W5pyA5paw5pWw5o2uCiAgICAgICAgbm9kZS5pc0xlYWYgPSBmYWxzZTsgLy/lsZXlvIDnqbrmlofku7blpLnlkI7vvIzkvJrlj5jmiJDlj7blrZDoioLngrnvvIzov5nph4zmiYvliqjorr7nva7miJDpnZ7lj7blrZDoioLngrkKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVzb2x2ZShbXSk7IC8vcmVzb2x2ZeepuuaVsOe7hOWQju+8jOS8muWPmOaIkOWPtuWtkOiKgueCue+8jOS4i+mdouiuvue9ruWbnumdnuWPtuWtkOiKgueCue+8jOW5tuS4lOiuvue9ruS4uumdnuWxleW8gOacquWKoOi9ve+8jOiuqeeUqOaIt+WPr+S7pemHjeaWsOeCueWHu+WKoOi9vQogICAgICAgIG5vZGUuZXhwYW5kZWQgPSBmYWxzZTsKICAgICAgICBub2RlLmxvYWRlZCA9IGZhbHNlOwogICAgICAgIG5vZGUuaXNMZWFmID0gZmFsc2U7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0sCiAgICBub2RlQ2xpY2s6IGZ1bmN0aW9uIG5vZGVDbGljayhub2RlLCBpdGVtLCBpbmRleCkgewogICAgICByZXF1ZXN0KHsKICAgICAgICB1cmw6ICcvd2Vic2hlbGwvcHJldmlld0ZpbGVCeUlkJywKICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBpZDogaXRlbS53ZWJzaGVsbElkLAogICAgICAgICAgcGF0aDogbm9kZS5kYXRhLnJlYWxwYXRoLAogICAgICAgICAgdHh0TGltaXQ6IE51bWJlcihpdGVtLnR4dExpbWl0KSwKICAgICAgICAgIGltZ0xpbWl0OiBOdW1iZXIoaXRlbS5pbWdMaW1pdCkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaXRlbS5maWxlRGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZVRhYnNFZGl0OiBmdW5jdGlvbiBoYW5kbGVUYWJzRWRpdCh0YXJnZXROYW1lLCBhY3Rpb24pIHsKICAgICAgaWYgKGFjdGlvbiA9PT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLnNlbGVjdFdlYnNoZWxsKGZhbHNlKTsKICAgICAgfQogICAgICBpZiAoYWN0aW9uID09PSAncmVtb3ZlJykgewogICAgICAgIHZhciB0YWJzID0gdGhpcy5jb250ZW50LnRhYnM7CiAgICAgICAgdmFyIGFjdGl2ZU5hbWUgPSB0aGlzLmNvbnRlbnQuY3VycmVudFRhYk5hbWU7CiAgICAgICAgaWYgKGFjdGl2ZU5hbWUgPT09IHRhcmdldE5hbWUpIHsKICAgICAgICAgIHRhYnMuZm9yRWFjaChmdW5jdGlvbiAodGFiLCBpbmRleCkgewogICAgICAgICAgICBpZiAodGFiLm5hbWUgPT09IHRhcmdldE5hbWUpIHsKICAgICAgICAgICAgICB2YXIgbmV4dFRhYiA9IHRhYnNbaW5kZXggKyAxXSB8fCB0YWJzW2luZGV4IC0gMV07CiAgICAgICAgICAgICAgaWYgKG5leHRUYWIpIHsKICAgICAgICAgICAgICAgIGFjdGl2ZU5hbWUgPSBuZXh0VGFiLm5hbWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgdGhpcy5jb250ZW50LmN1cnJlbnRUYWJOYW1lID0gYWN0aXZlTmFtZTsKICAgICAgICB0aGlzLmNvbnRlbnQudGFicyA9IHRhYnMuZmlsdGVyKGZ1bmN0aW9uICh0YWIpIHsKICAgICAgICAgIHJldHVybiB0YWIubmFtZSAhPT0gdGFyZ2V0TmFtZTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGZldGNoV2Vic2hlbGxEYXRhOiBmdW5jdGlvbiBmZXRjaFdlYnNoZWxsRGF0YSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgcmVxdWVzdCh7CiAgICAgICAgdXJsOiAnL3dlYnNoZWxsL2ZpbmRBbGwnLAogICAgICAgIG1ldGhvZDogJ2dldCcKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpcy53ZWJzaGVsbHMgPSByZXNwb25zZS5kYXRhOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIHNlbGVjdFdlYnNoZWxsOiBmdW5jdGlvbiBzZWxlY3RXZWJzaGVsbChpc0FkZFRhYikgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgaWYgKGlzQWRkVGFiKSB7CiAgICAgICAgdGhpcy5zZWxlY3RXZWJzaGVsbEZvcm0udmlzaWJsZSA9IGZhbHNlOwogICAgICAgIHZhciBuZXdUYWJOYW1lID0gKyt0aGlzLmNvbnRlbnQudGFiSW5kZXggKyAnJzsKICAgICAgICB2YXIgd2Vic2hlbGxJZCA9IHRoaXMuc2VsZWN0V2Vic2hlbGxGb3JtLndlYnNoZWxsSWQ7CiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5jb250ZW50LnRhYnMucHVzaCh7CiAgICAgICAgICB0aXRsZTogIuWKoOi9veS4rS4uLiIsCiAgICAgICAgICBuYW1lOiBuZXdUYWJOYW1lLAogICAgICAgICAgd2Vic2hlbGxJZDogd2Vic2hlbGxJZCwKICAgICAgICAgIGZpbGVEYXRhOiAiIiwKICAgICAgICAgIHR4dExpbWl0OiAxMDAsCiAgICAgICAgICBpbWdMaW1pdDogMTAyNAogICAgICAgIH0pIC0gMTsKICAgICAgICB0aGlzLmNvbnRlbnQuY3VycmVudFRhYk5hbWUgPSBuZXdUYWJOYW1lOwogICAgICAgIHJlcXVlc3QoewogICAgICAgICAgdXJsOiAnL3dlYnNoZWxsL2dldEFuZFVwZGF0ZUluZm9CeUlkJywKICAgICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgaWQ6IHdlYnNoZWxsSWQKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgdmFyIHVybCA9IHJlc3BvbnNlLmRhdGEudXJsOwogICAgICAgICAgdmFyIHJlcyA9IHVybC5tYXRjaCgvaHR0cHM/OlwvXC8oLiopP1wvLyk7CiAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgIF90aGlzMi5jb250ZW50LnRhYnNbaW5kZXhdLnRpdGxlID0gcmVzWzFdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXMyLmNvbnRlbnQudGFic1tpbmRleF0udGl0bGUgPSB1cmw7CiAgICAgICAgICB9CiAgICAgICAgICBfdGhpczIuJGZvcmNlVXBkYXRlKCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBfdGhpczIuY29udGVudC50YWJzW2luZGV4XS50aXRsZSA9ICLliqDovb3lpLHotKUiOwogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2VsZWN0V2Vic2hlbGxGb3JtLnZpc2libGUgPSB0cnVlOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaFdlYnNoZWxsRGF0YSgpOwogICAgdGhpcy5uYW1lID0gdGhpcy4kcm91dGUubmFtZTsKICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgdGhpcy5zZWxlY3RXZWJzaGVsbEZvcm0ud2Vic2hlbGxJZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgICAgdGhpcy5zZWxlY3RXZWJzaGVsbCh0cnVlKTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAkcm91dGU6IGZ1bmN0aW9uICRyb3V0ZSh0bywgZnJvbSkgewogICAgICBpZiAodG8ubmFtZSA9PSB0aGlzLm5hbWUpIHsKICAgICAgICB0aGlzLmZldGNoV2Vic2hlbGxEYXRhKCk7CiAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkgewogICAgICAgICAgdGhpcy5zZWxlY3RXZWJzaGVsbEZvcm0ud2Vic2hlbGxJZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgICAgICAgIHRoaXMuc2VsZWN0V2Vic2hlbGwodHJ1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgd2luZG93LnZ1ZSA9IHRoaXM7CiAgfQp9Ow=="},{"version":3,"names":["request","data","el_tree_props","label","isLeaf","webshells","content","currentTabName","tabIndex","tabs","selectWebshellForm","visible","webshellId","methods","loadNode","node","resolve","item","path","level","realpath","url","method","id","then","response","loaded","catch","error","expanded","console","log","nodeClick","index","txtLimit","Number","imgLimit","fileData","handleTabsEdit","targetName","action","selectWebshell","activeName","forEach","tab","name","nextTab","filter","fetchWebshellData","_this","isAddTab","_this2","newTabName","push","title","params","res","match","$forceUpdate","created","$route","watch","to","from","mounted","window","vue"],"sources":["src/views/filemanager/index.vue"],"sourcesContent":["<template>\n  <el-container>\n    <el-main>\n      <el-tabs v-model=\"content.currentTabName\" type=\"card\" editable @edit=\"handleTabsEdit\">\n        <el-tab-pane\n          :key=\"item.name\"\n          v-for=\"item, index in content.tabs\"\n          :label=\"item.title\"\n          :name=\"item.name\"\n        >\n\n              <el-container>\n\n                <el-aside style=\"border:1px solid #e5e7ec;padding-top: 0px;max-height: 800px;\" width=\"30%\">\n                    <el-tree\n                    lazy\n                    :props=\"el_tree_props\"\n                    :load=\"(node, resolve) => loadNode(node, resolve, item)\"\n                    @node-click=\"(object,node,component) => nodeClick(node,item,index)\">\n                    </el-tree>\n                </el-aside>\n\n                <el-main style=\"padding-top: 0px;margin-left:10px;\">\n\n                  <el-descriptions title=\"属性\" :column=\"1\" border>\n                    <el-descriptions-item label=\"真实路径\">{{item.fileData.realpath}}</el-descriptions-item>\n                    <el-descriptions-item label=\"文件大小\">{{item.fileData.size}}</el-descriptions-item>\n                    <el-descriptions-item label=\"权限信息\">{{item.fileData.perms}}</el-descriptions-item>\n                    <el-descriptions-item label=\"inode修改时间\">{{item.fileData.inode_change_time}}</el-descriptions-item>\n                    <el-descriptions-item label=\"文件修改时间\">{{item.fileData.modification_time}}</el-descriptions-item>\n                  </el-descriptions>\n\n                  <br>\n\n                  <el-descriptions title=\"预览\" :colon=\"false\">\n                    <template slot=\"extra\">\n                      <el-form :inline=\"true\">\n                        <el-form-item label=\"文本限制(KB)\">\n                          <el-select \n                            size=\"mini\" \n                            v-model=\"item.txtLimit\" \n                            placeholder=\"大小\" \n                            style=\"width:100px\"\n                            filterable\n                            allow-create>\n                            <el-option value=\"100\"></el-option>\n                            <el-option value=\"512\"></el-option>\n                          </el-select>\n                        </el-form-item>\n\n                        <el-form-item label=\"图片限制(KB)\">\n                          <el-select \n                            size=\"mini\" \n                            v-model=\"item.imgLimit\" \n                            placeholder=\"大小\" \n                            style=\"width:100px\"\n                            filterable\n                            allow-create>\n                            <el-option value=\"1024\"></el-option>\n                            <el-option value=\"5120\"></el-option>\n                          </el-select>\n                        </el-form-item>\n                      </el-form>\n                    </template>\n\n                    <el-descriptions-item>\n                      <el-empty v-if=\"!(item.fileData.is_txt || item.fileData.is_dir || item.fileData.is_img)\" description=\"无法预览\"></el-empty>\n\n                      <el-input\n                        v-if=\"item.fileData.is_txt\" \n                        type=\"textarea\"\n                        :rows=\"20\"\n                        :readonly=\"true\"\n                        v-model=\"item.fileData.preview\">\n                      </el-input>\n\n                      <el-image\n                        v-if=\"item.fileData.is_img\" \n                        :src=\"item.fileData.preview\">\n                      </el-image>\n\n                      <el-table\n                        v-if=\"item.fileData.is_dir\" \n                        :data=\"item.fileData.preview\"\n                        style=\"width: 100%\">\n                        <el-table-column\n                          label=\"名称\">\n                          <template slot-scope=\"scope\">\n                            <i v-if=\"scope.row.is_dir\" class=\"el-icon-folder\"></i>\n                            <i v-if=\"!scope.row.is_dir\" class=\"el-icon-document\"></i>\n                            <span style=\"margin-left: 10px\">{{ scope.row.name }}</span>\n                          </template>\n                        </el-table-column>\n                        <el-table-column\n                          prop=\"size\"\n                          label=\"大小\">\n                        </el-table-column>\n                        <el-table-column\n                          prop=\"perms\"\n                          label=\"权限\">\n                        </el-table-column>\n                        <el-table-column\n                          prop=\"inode_change_time\"\n                          label=\"inode改变时间\">\n                        </el-table-column>\n                        <el-table-column\n                          prop=\"modification_time\"\n                          label=\"最后修改时间\">\n                        </el-table-column>\n                      </el-table>\n\n                    </el-descriptions-item>\n                  </el-descriptions>\n\n                </el-main>\n\n              </el-container>\n\n\n\n        </el-tab-pane>\n      </el-tabs>\n      <el-empty v-if=\"content.tabs.length == 0\" description=\"未选择Webshell\"></el-empty>\n    </el-main>\n\n    <el-dialog title=\"选择数据\" :visible.sync=\"selectWebshellForm.visible\" width=\"40%\">\n      <el-form :model=\"selectWebshellForm\">\n        <el-form-item label=\"URL\" required>\n          <el-select v-model=\"selectWebshellForm.webshellId\" placeholder=\"请选择\" style=\"width:85%\">\n            <el-option\n              v-for=\"item in webshells\"\n              :key=\"item.id\"\n              :label=\"item.url\"\n              :value=\"item.id\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"selectWebshellForm.visible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"selectWebshell(true)\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n  </el-container>\n</template>\n\n<style>\n  .contextmenu {\n    border: 1px solid #ccc;\n    background: #fff;\n    z-index: 3000;\n    position: absolute;\n    list-style-type: none;\n    padding: 5px 0;\n    border-radius: 4px;\n    font-size: 14px;\n    color: #333;\n    box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, 0.2);\n  }\n  .contextmenu li {\n    margin: 0;\n    padding: 5px 10px;\n  }\n  .contextmenu li:hover {\n    background: #f2f2f2;\n    cursor: default;\n  }\n  .el-tree-node.is-expanded > .el-tree-node__children{\n    display: inline-block;\n  }\n</style>\n\n<script>\n  import request from '@/utils/request'\n\n  export default {\n    data() {\n      return {\n        el_tree_props:{\n          label: 'name',\n          isLeaf: 'is_leaf'\n        },\n\n        webshells: [\n        ],\n\n        content:{\n          currentTabName: \"1\",\n          tabIndex: 1,\n\n          tabs:[\n          ],\n        },\n\n        selectWebshellForm:{\n          visible: false,\n          webshellId: null,\n        }\n\n      }\n    },\n    methods: {\n      loadNode(node, resolve, item){\n        let path;\n        if (node.level === 0) {\n          path = \"\";\n        }else{\n          path = node.data.realpath;\n        }\n\n        request({\n          url: '/webshell/loadFilesById',\n          method: 'post',\n          data: { \n            id:item.webshellId,\n            path:path\n          } \n        }).then(response => {\n          resolve(response.data);\n          node.loaded = false;    //展开文件夹后，依然设置loaded为false，这样重新展开时才会再次请求后端，获取最新数据\n          node.isLeaf = false;    //展开空文件夹后，会变成叶子节点，这里手动设置成非叶子节点\n        }).catch(error => {\n          resolve([]);  //resolve空数组后，会变成叶子节点，下面设置回非叶子节点，并且设置为非展开未加载，让用户可以重新点击加载\n          node.expanded = false;\n          node.loaded = false;\n          node.isLeaf = false;\n          console.log(error);\n        })\n      },\n\n      nodeClick(node,item,index){\n        request({\n          url: '/webshell/previewFileById',\n          method: 'post',\n          data: { \n            id:item.webshellId,\n            path:node.data.realpath,\n            txtLimit:Number(item.txtLimit),\n            imgLimit:Number(item.imgLimit)\n          } \n        }).then(response => {\n          item.fileData = response.data;\n        }).catch(error => {\n          console.log(error);\n          console.log(error);\n        })\n      },\n\n      handleTabsEdit(targetName, action) {\n        if (action === 'add') {\n          this.selectWebshell(false);\n        }\n        if (action === 'remove') {\n          let tabs = this.content.tabs;\n          let activeName = this.content.currentTabName;\n          if (activeName === targetName) {\n            tabs.forEach((tab, index) => {\n              if (tab.name === targetName) {\n                let nextTab = tabs[index + 1] || tabs[index - 1];\n                if (nextTab) {\n                  activeName = nextTab.name;\n                }\n              }\n            });\n          }\n          \n          this.content.currentTabName = activeName;\n          this.content.tabs = tabs.filter(tab => tab.name !== targetName);\n        }\n      },\n\n      fetchWebshellData(){\n        request({\n          url: '/webshell/findAll',\n          method: 'get',\n        }).then(response => {\n          this.webshells = response.data;\n        }).catch(error => {\n          console.log(error);\n        })\n      },\n\n      selectWebshell(isAddTab){\n        if(isAddTab){\n          this.selectWebshellForm.visible = false;\n          let newTabName = ++this.content.tabIndex + '';\n          let webshellId = this.selectWebshellForm.webshellId;\n\n          let index = this.content.tabs.push({\n            title: \"加载中...\",\n            name: newTabName,\n            webshellId:webshellId,\n            fileData:\"\",\n            txtLimit:100,\n            imgLimit:1024\n          })-1;\n          this.content.currentTabName = newTabName;\n\n          request({\n            url: '/webshell/getAndUpdateInfoById',\n            method: 'get',\n            params: { id:webshellId } \n          }).then(response => {\n            var url = response.data.url;\n            var res = url.match(/https?:\\/\\/(.*)?\\//);\n            if(res){\n              this.content.tabs[index].title = res[1];\n            }else{\n              this.content.tabs[index].title = url;\n            }\n            this.$forceUpdate();\n          }).catch(error => {\n            this.content.tabs[index].title = \"加载失败\";\n            console.log(error);\n          })\n\n\n\n        }else{\n          this.selectWebshellForm.visible = true;\n        }\n      },\n\n\n    },\n\n    created(){\n      this.fetchWebshellData();\n      this.name = this.$route.name;\n      if(this.$route.params.id){\n        this.selectWebshellForm.webshellId = this.$route.params.id\n        this.selectWebshell(true);\n      }\n    },\n\n    watch: {\n      $route(to, from) {\n        if(to.name == this.name){\n          this.fetchWebshellData();\n          if(this.$route.params.id){\n            this.selectWebshellForm.webshellId = this.$route.params.id\n            this.selectWebshell(true);\n          }\n        }\n      }\n    },\n\n    mounted(){\n      window.vue = this;\n    },\n\n  };\n</script>"],"mappings":"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","ignoreList":[]}]}